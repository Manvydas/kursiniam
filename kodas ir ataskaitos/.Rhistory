for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic)
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic)
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(data3[i:i+50,])
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic)
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic$coeff)
}
or(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+60,])
print(modelis_po_aic$coeff)
}
```
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+60,])
print(modelis_po_aic$coeff)
}
?lm
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:i+60,])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:i+60,])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[1:50])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[1:50,])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
print(modelis_po_aic$coeff)
}
modelis_po_aic$coeff
c=data.frame()
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
c=rbind(c,modelis_po_aic$coeff)
}
c
View(c)
betu_lentele=data.frame()
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
betu_lentele
colnames(betu_lentele)=c("intercept","S&P350","nedarbas","infliacija","paslaugu pasitikejimas", "pramones pasitikejimas", "uzsakymu lukesciai")
betu_lentele
betu_lentele=data.frame()
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
colnames(betu_lentele)=c("intercept","S&P350","nedarbas","infliacija","paslaugu pasitikejimas", "pramones pasitikejimas", "uzsakymu lukesciai")
```
View(betu_lentele)
modelis_po_aic
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)")
View(betu_lentele)
View(betu_lentele)
cbind(betu_lentele,60:168)
View(betu_lentele)
c=cbind(betu_lentele,60:168)
View(c)
View(betu_lentele)
View(c)
View(betu_lentele)
View(c)
betu_lentele=cbind(betu_lentele,60:168)
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 60 imtyje)")
View(betu_lentele)
pdf("betos.pdf", height=45, width=10)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=20, width=15)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=20, width=15)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=20, width=15)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=30, width=30)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,80:168)
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
betu_lentele
betu_lentele=cbind(betu_lentele,80:168)
betu_lentele=cbind(betu_lentele,81:168)
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
betu_lentele
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 60 imtyje)")
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 80 imtyje)")
betu_lentele
View(betu_lentele)
betu_lentele=data.frame()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ SP350 + infliacija + mhope + phope +  ip + kursas,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 80 imtyje)")
View(betu_lentele)
colnames(betu_lentele)=c("intercept"," SP350","infliacija","mhope","phope", "ip","kursas", "paskutinis menesis(is viso 80 imtyje)")
View(betu_lentele)
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 80 imtyje)")
pdf("betos.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ SP350 + infliacija + mhope + phope +  ip + kursas,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," SP350","infliacija","mhope","phope", "ip","kursas", "paskutinis menesis(is viso 80 imtyje)")
pdf("betos2.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula =OMX ~ SP350 + nedarbas + infliacija + phope + pramhope + ul,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," SP350","nedarbas","infliacija","phope", "pramhope","ul", "paskutinis menesis(is viso 80 imtyje)")
pdf("betos2.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula =OMX ~ SP350 + nedarbas + infliacija + phope + pramhope + ul,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," SP350","nedarbas","infliacija","phope", "pramhope","ul", "paskutinis menesis(is viso 80 imtyje)")
pdf("betos2.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
library("quantmod")
library("forecast")
library("xts")
library("dplyr")
library("gridExtra")
library("dynlm")
library(ggplot2)
library(reshape2)
library("knitr")
library("tseries")
library("MASS")
library(car)
library(lmtest)
library(sandwich)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
plot(modelis_po_aic$res)
plot(modelis_po_aic$res,type="l")
plot(modelis_po_aic$res)
gen=function(pradzia,pirkti){
b=sample(pradzia:169,length(pirkti),replace=F)
return(sum(data3[b,"OMX"]))
}
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,c("OMX","SP350","infliacija","mhope","phope","ul","gkl","ip","kursas")])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>3){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,pradzia)
p=round(p,3)
}
return(p)
}
lentele=data.frame()
for(i in 9:168){
lentele=rbind(lentele,validation(i))
}
library("quantmod")
library("forecast")
library("xts")
library("dplyr")
library("gridExtra")
library("dynlm")
library(ggplot2)
library(reshape2)
library("knitr")
library("tseries")
library("MASS")
library(car)
library(lmtest)
library(sandwich)
lentele=data.frame()
for(i in 9:168){
lentele=rbind(lentele,validation(i))
}
lentele[,c(1:5)]=lentele[,c(5,2,3,1,4)]
colnames(lentele)=c("pradinis imties dydis","graza strategijos","vidutine random graza","tikimybe kad geriau uz random","sandoriu skaicius")
pdf("data_output_kai3.pdf", height=45, width=10)
grid.table(lentele)
dev.off()
lentele=data.frame()
for(i in 9:168){
lentele=rbind(lentele,validation(i))
}
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,c("OMX","SP350","infliacija","mhope","phope","ul","gkl","ip","kursas")])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>3){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,pradzia)
p=round(p,3)
}
return(p)
}
validation(90) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
lentele=data.frame()
for(i in 9:168){
lentele=rbind(lentele,validation(i))
}
validation(9) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>3){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,pradzia)
p=round(p,3)
}
return(p)
}
validation(9) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation(10) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation(15) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation(14) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,c("OMX","SP350","infliacija","mhope","phope","ul","gkl","ip","kursas")])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>5){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,pradzia)
p=round(p,3)
}
return(p)
}
validation(9) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
gen=function(pradzia,pirkti){
b=sample(pradzia:169,length(pirkti),replace=F)
return(sum(data3[b,"OMX"]))
}
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,c("OMX","SP350","infliacija","mhope","phope","ul","gkl","ip","kursas")])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>5){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,pradzia)
p=round(p,3)
}
return(p)
}
validation(90) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation(9) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
library("quantmod")
library("forecast")
library("xts")
library("dplyr")
library("gridExtra")
library("dynlm")
library(ggplot2)
library(reshape2)
library("knitr")
library("tseries")
library("MASS")
library(car)
library(lmtest)
library(sandwich)
gen=function(pradzia,pirkti){
b=sample(pradzia:169,length(pirkti),replace=F)
return(sum(data3[b,"OMX"]))
}
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,c("OMX","SP350","infliacija","mhope","phope","ul","gkl","ip","kursas")])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>5){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,pradzia)
p=round(p,3)
}
return(p)
}
validation(9) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation(15) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation(20) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation(40) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation(20) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
validation(30) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
lentele=data.frame()
for(i in 30:168){
lentele=rbind(lentele,validation(i))
}
lentele[,c(1:5)]=lentele[,c(5,2,3,1,4)]
colnames(lentele)=c("pradinis imties dydis","graza strategijos","vidutine random graza","tikimybe kad geriau uz random","sandoriu skaicius")
pdf("data_output_kai3.pdf", height=45, width=10)
grid.table(lentele)
dev.off()
gen=function(pradzia,pirkti){
b=sample(pradzia:169,length(pirkti),replace=F)
return(sum(data3[b,"OMX"]))
}
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[(i-29):i,])
a=predict(modelis_po_aic, data3[(i-pradzia+1):i,])
a=a[length(a)]
if(matrix(a)[1]>3){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,pradzia)
p=round(p,3)
}
return(p)
}
validation(70) # rolling window, kai 70 imtis
gen=function(pradzia,pirkti){
b=sample(pradzia:169,length(pirkti),replace=F)
return(sum(data3[b,"OMX"]))
}
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[(i-pradzia+1):i,])
a=predict(modelis_po_aic, data3[(i-pradzia+1):i,])
a=a[length(a)]
if(matrix(a)[1]>3){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,pradzia)
p=round(p,3)
}
return(p)
}
validation(70) # rolling window, kai 70 imtis
validation(70) # rolling window, kai 70 imtis

validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,c("OMX","SP350","infliacija","mhope","phope","ul","gkl","ip","kursas")])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>5){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,i)
}
return(p)
}
validation(90) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
a=validation(90) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
round(a,3)
gen=function(pradzia,pirkti){
b=sample(pradzia:169,length(pirkti),replace=F)
return(sum(data3[b,"OMX"]))
}
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,c("OMX","SP350","infliacija","mhope","phope","ul","gkl","ip","kursas")])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>5){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,i)
p=round(p,3)
}
return(p)
}
a=validation(90) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
a
lentele=data.frame()
for(i in 9:10){
lentele=rbind(lentele,validation(i))
}
colnames(lentele)=c("tikimybe kad geriau uz random","graza strategijos","vidutine random graza","sandoriu skaicius")
lentele
lentele=data.frame()
lentele=data.frame()
for(i in 9:10){
lentele=rbind(lentele,validation(i))
}
lentele
gen=function(pradzia,pirkti){
b=sample(pradzia:169,length(pirkti),replace=F)
return(sum(data3[b,"OMX"]))
}
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,c("OMX","SP350","infliacija","mhope","phope","ul","gkl","ip","kursas")])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>5){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=round(p,3)
}
return(p)
}
lentele=data.frame()
for(i in 9:10){
lentele=rbind(lentele,validation(i))
}
colnames(lentele)=c("tikimybe kad geriau uz random","graza strategijos","vidutine random graza","sandoriu skaicius")
lentele
gen=function(pradzia,pirkti){
b=sample(pradzia:169,length(pirkti),replace=F)
return(sum(data3[b,"OMX"]))
}
validation=function(pradzia){
pirkti=numeric()
for(i in pradzia:168){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[1:i,c("OMX","SP350","infliacija","mhope","phope","ul","gkl","ip","kursas")])
a=predict(modelis_po_aic, data3[1:i+1,])
a=a[length(a)]
if(matrix(a)[1]>5){pirkti=append(pirkti,i)}
}
graza=sum(data3[pirkti,"OMX"])
random=replicate(100000,gen(pradzia,pirkti))
p=mean(random>graza)
vidurkis_random = mean(random)
if(p==0){p="nebuvo pirkimu"}
else{
p=append(p,graza)
p=append(p,vidurkis_random)
p=append(p,length(pirkti))
p=append(p,pradzia)
p=round(p,3)
}
return(p)
}
validation(90) #kai pradine imtis 70, atsakymo prasme- tikimybe kad geriau uz random, graza strategijos, vidutine random graza, pirkimo skaicius
lentele=data.frame()
for(i in 9:10){
lentele=rbind(lentele,validation(i))
}
colnames(lentele)=c("tikimybe kad geriau uz random","graza strategijos","vidutine random graza","sandoriu skaicius","pradines imties dydis")
lentele
for(i in 9:12){
lentele=rbind(lentele,validation(i))
}
lentele=data.frame()
for(i in 9:12){
lentele=rbind(lentele,validation(i))
}
lentele
colnames(lentele)=c("tikimybe kad geriau uz random","graza strategijos","vidutine random graza","sandoriu skaicius","pradines imties dydis")
lentele
lentele[,c(1:5)]=lentele[,c(5,2,3,1,4)]
lentele
lentele
lentele[,c(1:5)]=lentele[,c(5,2,3,1,4)]
lentele
lentele[,c(1:5)]=lentele[,c(5,2,3,1,4)]
lentele
for(i in 9:12){
lentele=rbind(lentele,validation(i))
}
lentele[,c(1:5)]=lentele[,c(5,2,3,1,4)]
lentele
lentele=data.frame()
for(i in 9:12){
lentele=rbind(lentele,validation(i))
}
lentele[,c(1:5)]=lentele[,c(5,2,3,1,4)]
lentele
colnames(lentele)=c("pradines imties dydis","graza strategijos","vidutine random graza","tikimybe kad geriau uz random","sandoriu skaicius")
lentele
rownames(lentele)=NA
lentele
rownames(lentele)=NA
lentele
rowname(lentele)=NA
rownames(lentele)=NA
rownames(lentele)=NULL
lentele
rownames(lentele)=NULL
lentele
View(lentele)
lentele=data.frame()
for(i in 9:168){
lentele=rbind(lentele,validation(i))
}
lentele[,c(1:5)]=lentele[,c(5,2,3,1,4)]
colnames(lentele)=c("pradines imties dydis","graza strategijos","vidutine random graza","tikimybe kad geriau uz random","sandoriu skaicius")
View(lentele)
save(lentele,file="lentele.Rda")
write.table(lentele,file="lentele")
write.table(lentele,file="lentele.pdf")
library(gridExtra)
install.packages("gridExtra")
library(gridExtra)
pdf("data_output.pdf", height=11, width=8.5)
grid.table(lentele)
lentele
dev.on()
dev.off()
pdf("data_output.pdf", height=5, width=3)
grid.table(lentele)
dev.off()
pdf("data_output.pdf", height=15, width=12)
grid.table(lentele)
dev.off()
pdf("data_output.pdf", height=15, width=12)
grid.table(lentele)
dev.off()
pdf("data_output.pdf", height=15, width=12)
pdf("data_output.pdf", height=15, width=12)
grid.table(lentele)
dev.off()
pdf("data_output.pdf", height=22, width=10)
grid.table(lentele)
dev.off()
pdf("data_output.pdf", height=30, width=10)
grid.table(lentele)
dev.off()
pdf("data_output.pdf", height=40, width=10)
grid.table(lentele)
dev.off()
pdf("data_output.pdf", height=45, width=10)
grid.table(lentele)
dev.off()
pdf("data_output.pdf", height=45, width=10)
grid.table(lentele)
dev.off()
pdf("data_output.pdf", height=45, width=10)
grid.table(lentele)
dev.off()
colnames(lentele)=c("pradinis imties dydis","graza strategijos","vidutine random graza","tikimybe kad geriau uz random","sandoriu skaicius")
library(gridExtra)
pdf("data_output.pdf", height=45, width=10)
grid.table(lentele)
dev.off()
data=data3
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data)
modelis_po_aic
modelis_po_aic$coeff
modelis_po_aic$coeff[1]
class(modelis_po_aic$coeff)
modelis_po_aic$coeff
a=modelis_po_aic$coeff
a=modelis_po_aic$coeff
data=data3[1:50,]
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data)
a=modelis_po_aic$coeff
data=data3[,]
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data)
b=modelis_po_aic$coeff
a
b
c=append(a,c)
c=append(a,b)
c
c=rbind(a,b)
c
c=data.frame()
beta=function(data){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data)
}
beta=function(data){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data)
}
rollapply(data3, 20 ,beta,align="right")
library(quantmod)
rollapply(data3, 20 ,beta,align="right")
beta=function(data){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data)
}
rollapply(data3, 20 ,beta,align="right")
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
}
modelis_po_aic
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic)
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic)
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic)
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic)
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(data3[i:i+50,])
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic)
}
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+50,])
print(modelis_po_aic$coeff)
}
or(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+60,])
print(modelis_po_aic$coeff)
}
```
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), data = data3[i:i+60,])
print(modelis_po_aic$coeff)
}
?lm
for(i in 1:118){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:i+60,])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:i+60,])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[1:50])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[1:50,])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
print(modelis_po_aic$coeff)
}
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
print(modelis_po_aic$coeff)
}
modelis_po_aic$coeff
c=data.frame()
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
c=rbind(c,modelis_po_aic$coeff)
}
c
View(c)
betu_lentele=data.frame()
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
betu_lentele
colnames(betu_lentele)=c("intercept","S&P350","nedarbas","infliacija","paslaugu pasitikejimas", "pramones pasitikejimas", "uzsakymu lukesciai")
betu_lentele
betu_lentele=data.frame()
for(i in 1:108){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+60),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
colnames(betu_lentele)=c("intercept","S&P350","nedarbas","infliacija","paslaugu pasitikejimas", "pramones pasitikejimas", "uzsakymu lukesciai")
```
View(betu_lentele)
modelis_po_aic
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)")
View(betu_lentele)
View(betu_lentele)
cbind(betu_lentele,60:168)
View(betu_lentele)
c=cbind(betu_lentele,60:168)
View(c)
View(betu_lentele)
View(c)
View(betu_lentele)
View(c)
betu_lentele=cbind(betu_lentele,60:168)
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 60 imtyje)")
View(betu_lentele)
pdf("betos.pdf", height=45, width=10)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=20, width=15)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=20, width=15)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=20, width=15)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=30, width=30)
grid.table(betu_lentele)
dev.off()
pdf("betos.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,80:168)
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
betu_lentele
betu_lentele=cbind(betu_lentele,80:168)
betu_lentele=cbind(betu_lentele,81:168)
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(c,modelis_po_aic$coeff)
}
betu_lentele
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 60 imtyje)")
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 80 imtyje)")
betu_lentele
View(betu_lentele)
betu_lentele=data.frame()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ SP350 + infliacija + mhope + phope +  ip + kursas,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 80 imtyje)")
View(betu_lentele)
colnames(betu_lentele)=c("intercept"," SP350","infliacija","mhope","phope", "ip","kursas", "paskutinis menesis(is viso 80 imtyje)")
View(betu_lentele)
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," lag(SP350, 1)","lag(infliacija, 2)","lag(mhope, 3)","lag(phope, 12)", "lag(ul, 10)", "lag(gkl, 9)","lag(ip, 4)","lag(kursas, 2)", "paskutinis menesis(is viso 80 imtyje)")
pdf("betos.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula = OMX ~ SP350 + infliacija + mhope + phope +  ip + kursas,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," SP350","infliacija","mhope","phope", "ip","kursas", "paskutinis menesis(is viso 80 imtyje)")
pdf("betos2.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula =OMX ~ SP350 + nedarbas + infliacija + phope + pramhope + ul,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," SP350","nedarbas","infliacija","phope", "pramhope","ul", "paskutinis menesis(is viso 80 imtyje)")
pdf("betos2.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
betu_lentele=data.frame()
for(i in 1:88){
modelis_po_aic <- lm(formula =OMX ~ SP350 + nedarbas + infliacija + phope + pramhope + ul,data = data3[i:(i+80),])
betu_lentele=rbind(betu_lentele,modelis_po_aic$coeff)
}
betu_lentele=cbind(betu_lentele,81:168)
colnames(betu_lentele)=c("intercept"," SP350","nedarbas","infliacija","phope", "pramhope","ul", "paskutinis menesis(is viso 80 imtyje)")
pdf("betos2.pdf", height=40, width=25)
grid.table(betu_lentele)
dev.off()
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
library("quantmod")
library("forecast")
library("xts")
library("dplyr")
library("gridExtra")
library("dynlm")
library(ggplot2)
library(reshape2)
library("knitr")
library("tseries")
library("MASS")
library(car)
library(lmtest)
library(sandwich)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
modelis_po_aic <- lm(formula = OMX ~ lag(SP350, 1) + lag(infliacija, 2) + lag(mhope, 3) + lag(phope,12) + lag(ul, 10) + lag(gkl, 9) + lag(ip, 4) + lag(kursas,2), na.action=na.omit,data = data3)
durbinWatsonTest(modelis_po_aic)
plot(modelis_po_aic$res)
plot(modelis_po_aic$res,type="l")
plot(modelis_po_aic$res)

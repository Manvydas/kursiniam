setwd("..")
setwd("duomenys")
omx=read.csv("omx.csv")
duom=select(omx,OMX.raw,OMXV.Value)
colnames(duom) <- c("Data", "Verte")
ts <- xts(duom$Verte, as.Date(duom$Data, "%m/%d/%Y"))
ts_m = apply.monthly(ts, mean)
ts_m2 = apply.monthly(ts, last)
colnames(ts_m2) <- c( "OMX")
colnames(ts_m) <- c("OMX")
```
Kasyba ir karjerų eksploatacija:
```{r}
setwd("..")
setwd("duomenys")
salis="Lithuania"
indikatorius = NA                                                         # kol kas indikatoriaus nebus
folderio_pav="Turnover in industry - consumer durables"
failo_pav="sts_intv_m_1_Data.csv"
kasyba_karjerai=istraukimas(salis,folderio_pav,failo_pav,indikatorius,1)
colnames(kasyba_karjerai) <- c("Data", "kasyba_karje")
```
Mažmeninė prekyba:
```{r}
setwd("..")
setwd("duomenys")
folderio_pav="Turnover and volume of sales in wholesale and retail trade - monthly data"
failo_pav="sts_trtu_m_1_Data.csv"
mazmenine_prekyba=istraukimas(salis,folderio_pav,failo_pav,indikatorius,1)                 #didmeninės ir mažmeninės prekybos apyvarta ir pardavimų apimtis
colnames(mazmenine_prekyba) <- c("Data", "mazmenine_prekyba")
```
Statybų pasitikėjimas:
```{r}
setwd("..")
setwd("duomenys")
indikatorius="Construction confidence indicator"
folderio_pav="Sentiment indicators - monthly data"
failo_pav="ei_bssi_m_r2_1_Data.csv"
statybu_pasitikejimas=istraukimas(salis,folderio_pav,failo_pav,indikatorius,2)
colnames(statybu_pasitikejimas) <- c("Data", "statyb_pasitik")
```
Paslaugų pasitikėjimas:
```{r}
setwd("..")
setwd("duomenys")
indikatorius="Services Confidence Indicator"
folderio_pav="Sentiment indicators - monthly data"
failo_pav="ei_bssi_m_r2_1_Data.csv"
paslaugu_pasitikejimas=istraukimas(salis,folderio_pav,failo_pav,indikatorius,2)
colnames(paslaugu_pasitikejimas) <- c("Data", "paslaugu_pasitik")
```
Vartotojų pasitikėjimas:
```{r}
setwd("..")
setwd("duomenys")
indikatorius="Consumer confidence indicator"
folderio_pav="Sentiment indicators - monthly data"
failo_pav="ei_bssi_m_r2_1_Data.csv"
vartotoju_pasitikejimas=istraukimas(salis,folderio_pav,failo_pav,indikatorius,2)
colnames(vartotoju_pasitikejimas) <- c("Data", "vartot_pasitik")
```
Mažmeninis pasitikėjimas:
```{r}
setwd("..")
setwd("duomenys")
indikatorius="Retail confidence indicator"
folderio_pav="Sentiment indicators - monthly data"
failo_pav="ei_bssi_m_r2_1_Data.csv"
mazmeninis_pasitikejimas=istraukimas(salis,folderio_pav,failo_pav,indikatorius,2) #mažmeninės prekybos pasitikėjimo rodiklis
colnames(mazmeninis_pasitikejimas) <- c("Data", "mazm_pasitik")
```
Pramonės pasitikėjimas:
```{r}
setwd("..")
setwd("duomenys")
indikatorius="Industrial confidence indicator"
folderio_pav="Sentiment indicators - monthly data"
failo_pav="ei_bssi_m_r2_1_Data.csv"
pramones_pasitikejimas=istraukimas(salis,folderio_pav,failo_pav,indikatorius,2)
colnames(pramones_pasitikejimas) <- c("Data", "pram_pasitik")
```
Verslo aktyvumas:
```{r}
setwd("..")
setwd("duomenys")
indikatorius="Business activity (sales) development over the past 3 months"
folderio_pav="Mazmenine prekyba"
failo_pav="ei_bsrt_m_r2_1_Data.csv"
verslo_aktyvumas=istraukimas(salis,folderio_pav,failo_pav,indikatorius,2)
colnames(verslo_aktyvumas) <- c("Data", "versl_aktyv")
```
Turimos akcijos:
```{r}
setwd("..")
setwd("duomenys")
indikatorius="Volume of stocks currently hold"
folderio_pav="Mazmenine prekyba"
failo_pav="ei_bsrt_m_r2_1_Data.csv"
turimos_akcijos=istraukimas(salis,folderio_pav,failo_pav,indikatorius,2)
colnames(turimos_akcijos) <- c("Data", "turimos_akc")
```
Užsakymų lūkesčiai:
```{r}
setwd("..")
setwd("duomenys")
indikatorius="Expectations of the number of orders placed with suppliers over the next 3 months"
folderio_pav="Mazmenine prekyba"
failo_pav="ei_bsrt_m_r2_1_Data.csv"
uzsakymu_lukesciai=istraukimas(salis,folderio_pav,failo_pav,indikatorius,2)
colnames(uzsakymu_lukesciai) <- c("Data", "uzsak_luk")
```
Darbo Lygio lūkesčiai:
```{r}
setwd("..")
setwd("duomenys")
indikatorius="Employment expectations over the next 3 months"
folderio_pav="Mazmenine prekyba"
failo_pav="ei_bsrt_m_r2_1_Data.csv"
darbo_lygio_lukesciai=istraukimas(salis,folderio_pav,failo_pav,indikatorius,2)
colnames(darbo_lygio_lukesciai) <- c("Data", "darb_lyg_luk")
```
Nedarbas:
```{r}
setwd("..")
setwd("duomenys/nedarbas")
data = read.csv("ei_lmhu_m_1_Data.csv")
data = data[data$GEO == salis,]
nedarbas = select(data,TIME,Value)
colnames(nedarbas) <- c("Data", "nedarbas")
setwd("..")
```
Infliacija:
```{r}
setwd("..")
setwd("duomenys/infliacija")
data = read.csv("prc_hicp_mv12r_1_Data.csv")
data = data[data$GEO == salis,]
infliacija = select(data,TIME,Value)
colnames(infliacija) <- c("Data", "Infliacija")
setwd("..")
```
S&P 500:
```{r}
setwd("..")
setwd("duomenys/S&P 500")
data = read.csv("YAHOO-INDEX_GSPC.csv")
SP500=select(data,Date,Adjusted.Close)
colnames(SP500) <- c("Data", "SP500")
setwd("..")
```
S&P 350 Europe:
```{r}
setwd("..")
setwd("duomenys/S&P 350 Europe")
data = read.csv("GOOG-NYSEARCA_IEV.csv")
SP350=select(data,Date,Close)
colnames(SP350) <- c("Data", "SP350")
```
Sujungiami duomenys į vieną lentelę:
```{r}
data=full_join(SP350,SP500,by="Data")
data = data %>% arrange(-row_number())
dataset=Reduce(function(x, y) merge(x, y, all=TRUE), list(kasyba_karjerai, darbo_lygio_lukesciai,nedarbas, infliacija, mazmeninis_pasitikejimas, paslaugu_pasitikejimas, pramones_pasitikejimas, statybu_pasitikejimas, turimos_akcijos, uzsakymu_lukesciai, vartotoju_pasitikejimas, verslo_aktyvumas, mazmenine_prekyba ))
Data=dataset[,1]
dataset=dataset[,-1]
n=length(dataset[,1])
datafin=cbind(data[1:n,c(2,3)], dataset)
OMX=data.frame(ts_m)
colnames(OMX)=c("OMX")
datafin=cbind( OMX,datafin)
rownames(datafin) <- NULL
rawdata=cbind( Data,datafin)
setwd("..")
setwd("..")
setwd("kodas ir ataskaitos")
write.csv(rawdata, file = "rawdata.csv",row.names=FALSE)
```
View(data)
data=read.csv("rawdata.csv")
data[ data == ":" ] = NA
data=data[complete.cases(data),]
rownames(data)<-NULL
View(data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statybu_pasitikejimas+paslaugu_pasitikejimas+vartotoju_pasitikejimas+mazmeninis_pasitikejimas
+pramones_pasitikejimas+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darbolygio_lukesciai+infliacija,data=data)
View(data)
View(data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statybu_pasitikejimas+paslaugu_pasitikejimas+vartotoju_pasitikejimas+mazmeninis_pasitikejimas
+pramones_pasitikejimas+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
View(data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitikejimas+vartotoju_pasitikejimas+mazmeninis_pasitikejimas
+pramones_pasitikejimas+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
`
View(data)
View(data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartotoju_pasitik+mazmeninis_pasitik
+pramones_pasitik+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
mod
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartotoju_pasitik+mazmeninis_pasitik
+pramones_pasitik+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartotoju_pasitik+mazmeninis_pasitik
+pramones_pasitik+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
)
)
)
)
)
)
)
)
)
)
)
glgd
g}
{}
}
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartotoju_pasitik+mazmeninis_pasitik
+pramones_pasitik+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
View(data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazmeninis_pasitik
+pramones_pasitik+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazmen_pasitik
+pramones_pasitik+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
View(data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pramones_pasitik+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pramon_pasitik+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+verslo_aktyvumas+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+verslo_aktyv+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+verslo_akt+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
View(data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akcijos+uzsakymu_lukesciai+darb_lyg_luk+infliacija,data=data)
colnames(data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+infliacija,data=data)
tapply(data,class)
lapply(data,class)
?apply
apply(data[,-1],2,class)
apply(data[-1,-1],2,class)
apply(data[-1,-1],2,class)
data[-1,-1]
as.matrix(data[,-1])
apply(data[,-1],2,as.numeric)
data2=apply(data[,-1],2,as.numeric)
data2
View(data2)
View(data2)
View(data)
data2=cbind(data[,1],data2)
View(data2)
View(data2)
View(data)
data2=apply(data[,-1],2,as.numeric)
data[,1]
data2=cbind(data[,1],data2)
data2
View(data2)
data2=apply(data[,-1],2,as.numeric)
rownames(data2)=data[,1]
View(data2)
View(data)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data)
summary(mod)
mod=lm(OMX~SP350,data=data)
summary(mod)
mod=lm(log(OMX)~log(SP350),data=data)
mod
summary(mod)
mod=lm(log(OMX)~log(SP500),data=data)
summary(mod)
mod=lm(log(OMX)~log(SP350),data=data)
summary(mod)
mod=lm(log(OMX)~log(SP350),data=data)
summary(mod)
mod=lm(log(OMX)~log(SP500),data=data)
summary(mod)
mod=lm(log(OMX)~log(SP350),data=data)
summary(mod)
mod(log(SP500)~log(SP350))
mod2=lm(log(SP500)~log(SP350))
summary(mod2)
mod2=lm(log(SP500)~log(SP350))
mod2=lm(log(SP500)~log(SP350),data)
summary(mod2)
mod=lm(log(SP350)~log(SP500),data)
summary(mod)
summary(mod2)
summary(mod)
summary(mod2)
mod=lm(log(OMX)~log(SP350),data=data)
mod2=lm(log(OMX)~log(SP500),data=data)
summary(mod)
summary(mod2)
summary(mod)
summary(mod2)
mod=lm(OMX~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data)
summary(mod)
mod=lm(log(OMX)~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data2=data2)
summary(mod)
mod=lm(log(OMX)~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data2)
summary(mod)
apply(data[,-1],2,class)
data2=apply(data[,-1],2,as.numeric)
rownames(data2)=data[,1]
mod=lm(log(OMX)~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data2)
data2=data.frame(data2)
mod=lm(log(OMX)~mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data2)
summary(mod)
mod=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data2)
summary(mod)
AIC(mod)
apply(data[,-1],2,class)
apply(data2,2,class)
View(vartotoju_pasitikejimas)
View(data2)
mod=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data2)
View(duom)
View(data2)
data2$nedarbas=data2$nedarbas/1000
View(data2)
data=read.csv("rawdata.csv")
data[ data == ":" ] = NA
data=data[complete.cases(data),]
rownames(data)<-NULL
data2=apply(data[,-1],2,as.numeric)
rownames(data2)=data[,1]
data2=data.frame(data2)
data2$nedarbas=data2$nedarbas/10
View(data2)
mod=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data2)
summary(mod)
View(data2)
data2[,1]
View(data2)
diffdata=apply(data2[,4:length(data2[,1])],2,function(i) data2[-1,i] - data2[,i] )
length(data2[,1])
length(data2[,1])
length(data2[1,])
diffdata=apply(data2[,4:length(data2[1,])],2,function(i) data2[-1,i] - data2[,i] )
?diff
data.frame(diff(as.matrix(data2[,4:length(data2[1,])])))
data3=data.frame(diff(as.matrix(data2[,4:length(data2[1,])])))
View(data3)
View(data2)
data3 = data3 %>% cbind(data2[,1:4])
data3 = data3 %<% cbind(data2[,1:4])
data3 = data3 %>% cbind(data2[,1:4])
library("dplyr")
data3 = data3 %>% cbind(data2[,1:4])
data3 = data3 %>% cbind(data2[-1,1:4])
View(data3)
data3=data.frame(diff(as.matrix(data2[,4:length(data2[1,])])))
data3 =cbind( data3,data2[-1,1:4])
View(data3)
View(data2)
data3=data.frame(diff(as.matrix(data2[,4:length(data2[1,])])))
data3 =cbind( data2[-1,1:3],data3)
data3=data.frame(diff(as.matrix(data2[,4:length(data2[1,])])))
data3 =cbind( data2[-1,1:3],data3)
View(data3)
mod=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data2)
summary(mod)
mod2=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data3)
summary(mod2)
data4=data.frame(diff(data2))
data4=data.frame(diff(data2))
data4=data.frame(diff(data2[,1]))
View(data4)
data2[,1]
View(datafin)
View(data2)
data4=data.frame(diff(data2))
View(data2)
data4=data.frame(diff(data2))
data4=data.frame(diff(as.matrix(data2)))
View(data3)
View(data4)
data4=data.frame(diff(as.matrix(data2)))
mod2=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data3)
mod3=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data4)
summary(mod3)
pairs(data4,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor)
panel.hist <- function(x, ...)    #ši funkcija reikalinga grafikų lentelei išbrėžti (histogramos pateikimui)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(usr[1:2], 0, 1.5) )
h <- hist(x, plot = FALSE)
breaks <- h$breaks; nB <- length(breaks)
y <- h$counts; y <- y/max(y)
rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
}
panel.cor2 <- function(x, y, digits=2, cex.cor)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y))
txt <- format(c(r, 0.123456789), digits=digits)[1]
test <- cor.test(x,y)
Signif <- ifelse(round(test$p.value,3)<0.001,"p<0.001",paste("p=",round(test$p.value,3)))
text(0.5, 0.25, paste("r=",txt))
text(.5, .75, Signif)
}
pairs(data,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor2)
panel.hist <- function(x, ...)    #ši funkcija reikalinga grafikų lentelei išbrėžti (histogramos pateikimui)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(usr[1:2], 0, 1.5) )
h <- hist(x, plot = FALSE)
breaks <- h$breaks; nB <- length(breaks)
y <- h$counts; y <- y/max(y)
rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
}
panel.cor <- function(x, y, digits = 2, prefix = "", cex.cor,...)    #ši funkcija reikalinga grafikų lentelei
#išbrėžti (koreliacijos koeficiento radimui)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste0(prefix, txt)
if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = 3)
}
pairs(data4,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor)
pairs(data,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor)
pairs(data4,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor2)
pairs(data4,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor2)
summary(mod3)
pairs(data4,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor2)         #su diferencijuotais duomenim
data=read.csv("rawdata.csv")
data[ data == ":" ] = NA
data=data[complete.cases(data),]
rownames(data)<-NULL
panel.hist <- function(x, ...)    #ši funkcija reikalinga grafikų lentelei išbrėžti (histogramos pateikimui)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(usr[1:2], 0, 1.5) )
h <- hist(x, plot = FALSE)
breaks <- h$breaks; nB <- length(breaks)
y <- h$counts; y <- y/max(y)
rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
}
panel.cor2 <- function(x, y, digits=2, cex.cor)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y))
txt <- format(c(r, 0.123456789), digits=digits)[1]
test <- cor.test(x,y)
Signif <- ifelse(round(test$p.value,3)<0.001,"p<0.001",paste("p=",round(test$p.value,3)))
text(0.5, 0.25, paste("r=",txt))
text(.5, .75, Signif)
}
pairs(data,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor2)
panel.hist <- function(x, ...)    #ši funkcija reikalinga grafikų lentelei išbrėžti (histogramos pateikimui)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(usr[1:2], 0, 1.5) )
h <- hist(x, plot = FALSE)
breaks <- h$breaks; nB <- length(breaks)
y <- h$counts; y <- y/max(y)
rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
}
panel.cor <- function(x, y, digits = 2, prefix = "", cex.cor,...)    #ši funkcija reikalinga grafikų lentelei
#išbrėžti (koreliacijos koeficiento radimui)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste0(prefix, txt)
if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = 3)
}
pairs(data,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor2)
data2=apply(data[,-1],2,as.numeric)
rownames(data2)=data[,1]
data2=data.frame(data2)
data2$nedarbas=data2$nedarbas/10
mod=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data2)
summary(mod)
data3=data.frame(diff(as.matrix(data2[,4:length(data2[1,])])))
data3 =cbind( data2[-1,1:3],data3)
mod2=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data3)
summary(mod2)
data4=data.frame(diff(as.matrix(data2)))
mod3=lm(log(OMX)~log(SP350)+mazmenine_prekyba+kasyba_karje+statyb_pasitik+paslaugu_pasitik+vartot_pasitik+mazm_pasitik
+pram_pasitik+versl_aktyv+turimos_akc+uzsak_luk+darb_lyg_luk+Infliacija,data=data4)
summary(mod3)
pairs(data4,upper.panel=panel.smooth,diag.panel=panel.hist, lower.panel=panel.cor2)         #su diferencijuotais duomenim
